<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/kadirahq/meteor-up#readme">mup (v1.2.6)</a>
</h1>
<h4>Production Quality Meteor Deployments</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.mup">module mup</a><ol>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mup.</span>commands</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mup.</span>custom_errors</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mup.</span>meteor</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mup.</span>mongo</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mup.</span>mup_api</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mup.</span>servers</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mup.</span>updates</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">mup.</span>utils</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mup.commands">module mup.commands</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.commands.commands">
            function <span class="apidocSignatureSpan">mup.</span>commands
            <span class="apidocSignatureSpan">(parser)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mup.custom_errors">module mup.custom_errors</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.custom_errors.HiddenError">
            function <span class="apidocSignatureSpan">mup.custom_errors.</span>HiddenError
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mup.meteor">module mup.meteor</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.meteor.default">
            function <span class="apidocSignatureSpan">mup.meteor.</span>default
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mup.mongo">module mup.mongo</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.mongo.default">
            function <span class="apidocSignatureSpan">mup.mongo.</span>default
            <span class="apidocSignatureSpan">(config)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mup.mup_api">module mup.mup_api</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.mup_api.default">
            function <span class="apidocSignatureSpan">mup.mup_api.</span>default
            <span class="apidocSignatureSpan">(base, args, configPath, settingsPath, verbose)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mup.servers">module mup.servers</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.servers.default">
            function <span class="apidocSignatureSpan">mup.servers.</span>default
            <span class="apidocSignatureSpan">(servers)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mup.updates">module mup.updates</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.updates.default">
            function <span class="apidocSignatureSpan">mup.updates.</span>default
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.mup.utils">module mup.utils</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.utils.countOccurences">
            function <span class="apidocSignatureSpan">mup.utils.</span>countOccurences
            <span class="apidocSignatureSpan">(needle, haystack)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.utils.getDockerLogs">
            function <span class="apidocSignatureSpan">mup.utils.</span>getDockerLogs
            <span class="apidocSignatureSpan">(name, sessions, args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.utils.resolvePath">
            function <span class="apidocSignatureSpan">mup.utils.</span>resolvePath
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.utils.runSSHCommand">
            function <span class="apidocSignatureSpan">mup.utils.</span>runSSHCommand
            <span class="apidocSignatureSpan">(info, command)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.mup.utils.runTaskList">
            function <span class="apidocSignatureSpan">mup.utils.</span>runTaskList
            <span class="apidocSignatureSpan">(list, sessions, opts)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mup" id="apidoc.module.mup">module mup</a></h1>

















</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mup.commands" id="apidoc.module.mup.commands">module mup.commands</a></h1>


    <h2>
        <a href="#apidoc.element.mup.commands.commands" id="apidoc.element.mup.commands.commands">
        function <span class="apidocSignatureSpan">mup.</span>commands
        <span class="apidocSignatureSpan">(parser)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function commands(parser) {
  return parser.command('init', 'Setup files for new mup project', {}, commandFunctions.init).command('deploy', 'Deploy app to servers
', function (yargs) {
    return yargs.option('cached-build', {
      description: 'Use build from previous deploy',
      boolean: true
    });
  }, commandFunctions.deploy).command('logs', "Show app's logs. Supports options from docker logs", function (yargs) {
    return yargs.strict(false).option('tail', {
      description: 'Number of lines to show from the end of the logs',
      number: true,
      default: 'all'
    }).option('follow', {
      description: 'Follow log output',
      alias: 'f',
      boolean: true
    });
  }, commandFunctions.logs).command('reconfig', 'Updates server env and start script to match config', {}, commandFunctions.reconfig
).command('restart', 'Restart apps', {}, commandFunctions.restart).command('setup', 'Install depedencies on server, setups custom
 certificates and mongodb to match config', {}, commandFunctions.setup).command('start', 'Start app', {}, commandFunctions.start
).command('stop', 'Stop app', {}, commandFunctions.stop);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mup.custom_errors" id="apidoc.module.mup.custom_errors">module mup.custom_errors</a></h1>


    <h2>
        <a href="#apidoc.element.mup.custom_errors.HiddenError" id="apidoc.element.mup.custom_errors.HiddenError">
        function <span class="apidocSignatureSpan">mup.custom_errors.</span>HiddenError
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function HiddenError() {
  _classCallCheck(this, HiddenError);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mup.meteor" id="apidoc.module.mup.meteor">module mup.meteor</a></h1>


    <h2>
        <a href="#apidoc.element.mup.meteor.default" id="apidoc.element.mup.meteor.default">
        function <span class="apidocSignatureSpan">mup.meteor.</span>default
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">default = function (config) {
  var details = [];
  details = (0, _utils.combineErrorDetails)(details, _joi2.default.validate(config.meteor, schema, _utils.VALIDATE_OPTIONS));
  if (config.meteor.name.indexOf(' ') &gt; -1) {
    details.push({
      message: '"name" has a space'
    });
  }
  details = (0, _utils.combineErrorDetails)(details, (0, _utils.serversExist)(config.servers, config.meteor.servers));

  return (0, _utils.addLocation)(details, 'meteor');
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return new Promise(function (resolve) {
var params = {
  timeout: 1000,
  package: _package2.default.name,
  auth: {}
};

var npm = new _silentNpmRegistryClient2.<span class="apidocCodeKeywordSpan">default</span>();
var uri = 'https://registry.npmjs.org/npm';
npm.distTags.fetch(uri, params, function (err, res) {
  if (err) {
    resolve();
    return;
  }
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mup.mongo" id="apidoc.module.mup.mongo">module mup.mongo</a></h1>


    <h2>
        <a href="#apidoc.element.mup.mongo.default" id="apidoc.element.mup.mongo.default">
        function <span class="apidocSignatureSpan">mup.mongo.</span>default
        <span class="apidocSignatureSpan">(config)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">default = function (config) {
  var details = [];
  var validationErrors = _joi2.default.validate(config.mongo, schema, _utils.VALIDATE_OPTIONS);
  details = (0, _utils.combineErrorDetails)(details, validationErrors);
  details = (0, _utils.combineErrorDetails)(details, (0, _utils.serversExist)(config.servers, config.mongo.servers));
  return (0, _utils.addLocation)(details, 'mongo');
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return new Promise(function (resolve) {
var params = {
  timeout: 1000,
  package: _package2.default.name,
  auth: {}
};

var npm = new _silentNpmRegistryClient2.<span class="apidocCodeKeywordSpan">default</span>();
var uri = 'https://registry.npmjs.org/npm';
npm.distTags.fetch(uri, params, function (err, res) {
  if (err) {
    resolve();
    return;
  }
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mup.mup_api" id="apidoc.module.mup.mup_api">module mup.mup_api</a></h1>


    <h2>
        <a href="#apidoc.element.mup.mup_api.default" id="apidoc.element.mup.mup_api.default">
        function <span class="apidocSignatureSpan">mup.mup_api.</span>default
        <span class="apidocSignatureSpan">(base, args, configPath, settingsPath, verbose)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function MupAPI(base, args, configPath, settingsPath, verbose) {
  _classCallCheck(this, MupAPI);

  this.base = base;
  this.args = args;
  this.config = null;
  this.settings = null;
  this.sessions = null;
  this.configPath = configPath;
  this.settingsPath = settingsPath;
  this.verbose = verbose;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return new Promise(function (resolve) {
var params = {
  timeout: 1000,
  package: _package2.default.name,
  auth: {}
};

var npm = new _silentNpmRegistryClient2.<span class="apidocCodeKeywordSpan">default</span>();
var uri = 'https://registry.npmjs.org/npm';
npm.distTags.fetch(uri, params, function (err, res) {
  if (err) {
    resolve();
    return;
  }
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mup.servers" id="apidoc.module.mup.servers">module mup.servers</a></h1>


    <h2>
        <a href="#apidoc.element.mup.servers.default" id="apidoc.element.mup.servers.default">
        function <span class="apidocSignatureSpan">mup.servers.</span>default
        <span class="apidocSignatureSpan">(servers)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function validateServers(servers) {
  var details = [];
  var result = _joi2.default.validate(servers, schema, _utils.VALIDATE_OPTIONS);
  details = (0, _utils.combineErrorDetails)(details, result);
  return (0, _utils.addLocation)(details, 'servers');
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return new Promise(function (resolve) {
var params = {
  timeout: 1000,
  package: _package2.default.name,
  auth: {}
};

var npm = new _silentNpmRegistryClient2.<span class="apidocCodeKeywordSpan">default</span>();
var uri = 'https://registry.npmjs.org/npm';
npm.distTags.fetch(uri, params, function (err, res) {
  if (err) {
    resolve();
    return;
  }
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mup.updates" id="apidoc.module.mup.updates">module mup.updates</a></h1>


    <h2>
        <a href="#apidoc.element.mup.updates.default" id="apidoc.element.mup.updates.default">
        function <span class="apidocSignatureSpan">mup.updates.</span>default
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">default = function () {
  return new Promise(function (resolve) {
    var params = {
      timeout: 1000,
      package: _package2.default.name,
      auth: {}
    };

    var npm = new _silentNpmRegistryClient2.default();
    var uri = 'https://registry.npmjs.org/npm';
    npm.distTags.fetch(uri, params, function (err, res) {
      if (err) {
        resolve();
        return;
      }

      var npmVersion = res.latest;
      var local = _package2.default.version.split('.').map(function (n) {
        return Number(n);
      });
      var remote = npmVersion.split('.').map(function (n) {
        return Number(n);
      });

      var available = remote[0] &gt; local[0] || remote[0] === local[0] &amp;&amp; remote[1] &gt; local[1] || remote[1] === local[1] &amp;&amp; remote
[2] &gt; local[2];

      if (available) {
        var text = 'update available ' + _package2.default.version + ' =&gt; ' + npmVersion;
        text += '\nTo update, run ' + _chalk2.default.green('npm i -g mup');
        console.log((0, _boxen2.default)(text, {
          padding: 1,
          margin: 1,
          align: 'center',
          borderColor: 'yellow'
        }));
      }

      resolve();
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return new Promise(function (resolve) {
var params = {
  timeout: 1000,
  package: _package2.default.name,
  auth: {}
};

var npm = new _silentNpmRegistryClient2.<span class="apidocCodeKeywordSpan">default</span>();
var uri = 'https://registry.npmjs.org/npm';
npm.distTags.fetch(uri, params, function (err, res) {
  if (err) {
    resolve();
    return;
  }
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.mup.utils" id="apidoc.module.mup.utils">module mup.utils</a></h1>


    <h2>
        <a href="#apidoc.element.mup.utils.countOccurences" id="apidoc.element.mup.utils.countOccurences">
        function <span class="apidocSignatureSpan">mup.utils.</span>countOccurences
        <span class="apidocSignatureSpan">(needle, haystack)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function countOccurences(needle, haystack) {
  var regex = new RegExp(needle, 'g');
  var match = haystack.match(regex) || [];
  return match.length;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mup.utils.getDockerLogs" id="apidoc.element.mup.utils.getDockerLogs">
        function <span class="apidocSignatureSpan">mup.utils.</span>getDockerLogs
        <span class="apidocSignatureSpan">(name, sessions, args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getDockerLogs(name, sessions, args) {
  var command = 'sudo docker ' + args.join(' ') + ' ' + name + ' 2&gt;&amp;1';

  log('getDockerLogs command: ' + command);

  var promises = _.map(sessions, function (session) {
    var input = new Callback2Stream();
    var host = '[' + session._host + ']';
    var lineSeperator = _readline2.default.createInterface({
      input: input,
      terminal: true
    });
    lineSeperator.on('line', function (data) {
      console.log(host + data);
    });
    var options = {
      onStdout: function onStdout(data) {
        input.addData(data);
      },
      onStderr: function onStderr(data) {
        // the logs all come in on stdout so stderr isn't added to lineSeperator
        process.stdout.write(host + data);
      }
    };
    return (0, _bluebird.promisify)(session.execute.bind(session))(command, options);
  });
  return Promise.all(promises);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mup.utils.resolvePath" id="apidoc.element.mup.utils.resolvePath">
        function <span class="apidocSignatureSpan">mup.utils.</span>resolvePath
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function resolvePath() {
  for (var _len = arguments.length, paths = Array(_len), _key = 0; _key &lt; _len; _key++) {
    paths[_key] = arguments[_key];
  }

  var expandedPaths = paths.map(function (_path) {
    return (0, _expandTilde2.default)(_path);
  });
  return _path3.default.resolve.apply(_path3.default, _toConsumableArray(expandedPaths));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mup.utils.runSSHCommand" id="apidoc.element.mup.utils.runSSHCommand">
        function <span class="apidocSignatureSpan">mup.utils.</span>runSSHCommand
        <span class="apidocSignatureSpan">(info, command)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function runSSHCommand(info, command) {
  return new Promise(function (resolve, reject) {
    var conn = new _ssh.Client();

    // TODO better if we can extract SSH agent info from original session
    var sshAgent = process.env.SSH_AUTH_SOCK;
    var ssh = {
      host: info.host,
      port: info.opts &amp;&amp; info.opts.port || 22,
      username: info.username
    };

    if (info.pem) {
      ssh.privateKey = _fs2.default.readFileSync(resolvePath(info.pem), 'utf8');
    } else if (info.password) {
      ssh.password = info.password;
    } else if (sshAgent &amp;&amp; _fs2.default.existsSync(sshAgent)) {
      ssh.agent = sshAgent;
    }
    conn.connect(ssh);

    conn.once('error', function (err) {
      if (err) {
        reject(err);
      }
    });

    // TODO handle error events
    conn.once('ready', function () {
      conn.exec(command, function (err, outputStream) {
        if (err) {
          conn.end();
          reject(err);
          return;
        }

        var output = '';

        outputStream.on('data', function (data) {
          output += data;
        });

        outputStream.once('close', function (code) {
          conn.end();
          resolve({ code: code, output: output });
        });
      });
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.mup.utils.runTaskList" id="apidoc.element.mup.utils.runTaskList">
        function <span class="apidocSignatureSpan">mup.utils.</span>runTaskList
        <span class="apidocSignatureSpan">(list, sessions, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function runTaskList(list, sessions, opts) {
  if (opts &amp;&amp; opts.verbose) {
    addStdioHandlers(list);
    delete opts.verbose;
  }
  return new Promise(function (resolve, reject) {
    list.run(sessions, opts, function (summaryMap) {
      for (var host in summaryMap) {
        if (summaryMap.hasOwnProperty(host)) {
          var summary = summaryMap[host];
          if (summary.error) {
            var error = summary.error;
            error.nodemiralHistory = summary.history;
            reject(error);

            return;
          }
        }
      }

      resolve();
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>